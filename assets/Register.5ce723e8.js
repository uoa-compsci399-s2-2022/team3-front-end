import{d as U,g as f,Y as y,X as B,M as N,N as q,f as T,q as L,O as $,o as v,c as A,b as t,a as p,w as r,F as M,A as O,B as G,r as X,e as V,G as w,t as Y,u as j,V as I,a0 as g,_ as z}from"./index.594ced5a.js";/* empty css                     *//* empty css                 */import{_ as H}from"./uoa.f112d51c.js";import{L as J}from"./LoginBackground.229ac536.js";const S=c=>(O("data-v-93d1b60e"),c=c(),G(),c),K={class:"container"},Q={class:"register-window"},W=S(()=>p("h1",null,"Register",-1)),Z=S(()=>p("img",{src:H,alt:"",class:"logo"},null,-1)),ee={style:{display:"flex","column-gap":"20px"}},te=w("Send Code"),se=w("Submit "),ae=U({__name:"Register",setup(c){const u=f(),b=(o,e,a)=>{if(e==="")a(new Error("Please input the password"));else{if(s.repeatPassword!==""){if(!u.value)return;u.value.validateField("rep    eatPassword",()=>null)}a()}},P=(o,e,a)=>{e===""?a(new Error("Please input the password again")):e!==s.password?a(new Error("Two inputs don't match!")):a()},s=y({userID:"",password:"",repeatPassword:"",email:"",name:"",code:""}),D=y({userID:[{required:!0,message:"Please input userID",trigger:"blur"}],password:[{validator:b,trigger:"blur"}],repeatPassword:[{validator:P,trigger:"blur"}],email:[{required:!0,message:"Please input email address",trigger:"blur"}],name:[{required:!0,message:"Please input your name",trigger:"blur"}],code:[{required:!0,message:"Please input validation code",trigger:"blur"}]}),x=B(),E=()=>{I("/api/registerUser",s).then(o=>{g({message:"Register success.",type:"success"})}).then(()=>{x.push("/login")}).catch(o=>{g({message:`${o.response.data.message}`,type:"error"})})};let n,i=f(NaN);const m=f(!1),F=async()=>{if(!await u.value.validateField("email",()=>null))return;n=new Date,n.setSeconds(n.getSeconds()+10),localStorage.setItem("end_time",n.toISOString()),i.value=n.getSeconds()-new Date().getSeconds(),m.value=!0;let o=setInterval(()=>{i.value=n.getSeconds()-new Date().getSeconds(),i.value<=0&&(clearInterval(o),m.value=!1,localStorage.removeItem("end_time"))},1e3);I("/api/sendValidationEmail",{email:s.email}).then(e=>{g({message:"Validation code email has been sent to your email.",type:"success"})}).catch(e=>{g({message:`${e.response.data.message}`,type:"error"})})};if(localStorage.getItem("end_time")&&(n=new Date(localStorage.getItem("end_time")),i.value=n.getSeconds()-new Date().getSeconds(),i.value>0)){m.value=!0;let o=setInterval(()=>{i.value=n.getSeconds()-new Date().getSeconds(),i.value<=0&&(clearInterval(o),m.value=!1,localStorage.removeItem("end_time"))},1e3)}const C=o=>{!o||o.validate(e=>{if(e)console.log("submit!"),E();else return console.log("error submit!"),!1})};return(o,e)=>{const a=N,d=q,h=X("Timer"),k=T,_=L,R=$;return v(),A(M,null,[t(J),p("div",K,[p("div",Q,[W,Z,t(R,{ref_key:"registerFormRef",ref:u,model:s,"status-icon":"",rules:D,"label-width":"150px",class:"demo-registerForm","hide-required-asterisk":""},{default:r(()=>[t(d,{label:"UserID",prop:"userID"},{default:r(()=>[t(a,{modelValue:s.userID,"onUpdate:modelValue":e[0]||(e[0]=l=>s.userID=l),type:"text"},null,8,["modelValue"])]),_:1}),t(d,{label:"Password",prop:"password"},{default:r(()=>[t(a,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=l=>s.password=l),type:"password"},null,8,["modelValue"])]),_:1}),t(d,{label:"Confirm",prop:"repeatPassword"},{default:r(()=>[t(a,{modelValue:s.repeatPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>s.repeatPassword=l),type:"password"},null,8,["modelValue"])]),_:1}),t(d,{label:"Name",prop:"name"},{default:r(()=>[t(a,{modelValue:s.name,"onUpdate:modelValue":e[3]||(e[3]=l=>s.name=l),type:"text"},null,8,["modelValue"])]),_:1}),p("div",ee,[t(d,{label:"Email",prop:"email"},{default:r(()=>[t(a,{modelValue:s.email,"onUpdate:modelValue":e[4]||(e[4]=l=>s.email=l),type:"text"},null,8,["modelValue"])]),_:1}),m.value?(v(),V(_,{key:0,type:"info",onClick:e[5]||(e[5]=()=>{}),plain:"",disabled:"",class:"verification"},{default:r(()=>[t(k,null,{default:r(()=>[t(h)]),_:1}),w("After "+Y(j(i))+"s to resend ",1)]),_:1})):(v(),V(_,{key:1,type:"primary",onClick:F,plain:"",class:"verification"},{default:r(()=>[te]),_:1}))]),t(d,{label:"Verification Code",prop:"code"},{default:r(()=>[t(a,{modelValue:s.code,"onUpdate:modelValue":e[6]||(e[6]=l=>s.code=l),type:"text"},null,8,["modelValue"])]),_:1}),t(d,null,{default:r(()=>[t(_,{type:"primary",onClick:e[7]||(e[7]=l=>C(u.value)),style:{width:"100%"}},{default:r(()=>[se]),_:1})]),_:1})]),_:1},8,["model","rules"])])])],64)}}});const de=z(ae,[["__scopeId","data-v-93d1b60e"]]);export{de as default};
